variables:
  - template: global/vars.yml
  - group: credentials

trigger:
  - master
  - pull/*
  - build/*

stages:
- stage:
  displayName: Build & Test
  jobs:
  - template: quality/copyright_check.yml
  - job:
    displayName: Running build and unit tests
    pool:
      vmImage: macOS-10.14
    steps:
    - task: Gradle@2
      inputs:
        workingDirectory: ''
        gradleWrapperFile: 'gradlew'
        gradleOptions: '-Xmx3072m'
        javaHomeOption: 'JDKVersion'
        jdkVersionOption: '1.8'
        jdkArchitectureOption: 'x64'
        publishJUnitResults: true
        testResultsFiles: '**/TEST-*.xml'
        tasks: 'assembleDebug test'
      displayName: gradlew assembleDebug test
